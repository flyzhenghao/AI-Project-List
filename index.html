<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>AI Project Command Center | Harry's Portfolio</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <style>
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                font-family: "Space Grotesk", "Noto Sans SC", sans-serif;
                background: linear-gradient(
                    135deg,
                    #0a0a0f 0%,
                    #1a1a2e 50%,
                    #0a0a0f 100%
                );
                min-height: 100vh;
                color: #e0e0e0;
            }

            ::-webkit-scrollbar {
                width: 8px;
            }

            ::-webkit-scrollbar-track {
                background: #1a1a2e;
            }

            ::-webkit-scrollbar-thumb {
                background: #3d3d5c;
                border-radius: 4px;
            }

            .container {
                max-width: 1400px;
                margin: 0 auto;
                padding: 0 40px;
            }

            /* Header */
            header {
                background: linear-gradient(
                    180deg,
                    rgba(99, 102, 241, 0.1) 0%,
                    transparent 100%
                );
                border-bottom: 1px solid rgba(99, 102, 241, 0.2);
                padding: 24px 0;
            }

            .header-content {
                display: flex;
                justify-content: space-between;
                align-items: center;
                flex-wrap: wrap;
                gap: 20px;
            }

            .title {
                font-size: 32px;
                font-weight: 700;
                color: #fff;
                display: flex;
                align-items: center;
                gap: 12px;
                text-shadow: 0 0 30px rgba(99, 102, 241, 0.5);
            }

            .title-icon {
                font-size: 36px;
            }

            .subtitle {
                margin-top: 8px;
                color: #888;
                font-size: 14px;
            }

            .header-actions {
                display: flex;
                gap: 12px;
                flex-wrap: wrap;
                align-items: center;
            }

            /* Language Toggle */
            .lang-toggle {
                display: flex;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 8px;
                overflow: hidden;
            }

            .lang-btn {
                padding: 10px 16px;
                background: transparent;
                border: none;
                color: #888;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                font-family: inherit;
                transition: all 0.2s;
            }

            .lang-btn:hover {
                color: #fff;
            }

            .lang-btn.active {
                background: rgba(99, 102, 241, 0.3);
                color: #fff;
            }

            .btn {
                padding: 10px 20px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 14px;
                font-weight: 500;
                font-family: inherit;
                transition: all 0.2s;
                border: none;
            }

            .btn-secondary {
                background: rgba(99, 102, 241, 0.1);
                border: 1px solid rgba(99, 102, 241, 0.3);
                color: #a5b4fc;
            }

            .btn-secondary:hover {
                background: rgba(99, 102, 241, 0.2);
            }

            .btn-primary {
                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                color: #fff;
                font-weight: 600;
                box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            }

            .btn-primary:hover {
                transform: translateY(-1px);
                box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
            }

            .file-input {
                display: none;
            }

            /* Stats Bar */
            .stats-bar {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 16px;
                margin: 30px 0;
            }

            .stat-card {
                background: rgba(255, 255, 255, 0.03);
                border: 1px solid rgba(255, 255, 255, 0.08);
                border-left-width: 3px;
                border-radius: 12px;
                padding: 20px;
                text-align: center;
            }

            .stat-card.done {
                border-left-color: #10b981;
            }
            .stat-card.ing {
                border-left-color: #f59e0b;
            }
            .stat-card.initial {
                border-left-color: #6366f1;
            }

            .stat-number {
                display: block;
                font-size: 32px;
                font-weight: 700;
                color: #fff;
            }

            .stat-card.done .stat-number {
                color: #10b981;
            }
            .stat-card.ing .stat-number {
                color: #f59e0b;
            }
            .stat-card.initial .stat-number {
                color: #6366f1;
            }

            .stat-label {
                font-size: 12px;
                color: #666;
                text-transform: uppercase;
                letter-spacing: 1px;
                margin-top: 4px;
                display: block;
            }

            /* Filters */
            .filters {
                display: flex;
                gap: 16px;
                flex-wrap: wrap;
                margin-bottom: 30px;
            }

            .search-input {
                flex: 1;
                min-width: 250px;
                padding: 12px 16px;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 8px;
                color: #fff;
                font-size: 14px;
                font-family: inherit;
            }

            .search-input:focus,
            .filter-select:focus {
                outline: none;
                border-color: #6366f1;
                box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
            }

            .filter-select {
                padding: 12px 16px;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 8px;
                color: #fff;
                font-size: 14px;
                font-family: inherit;
                cursor: pointer;
                min-width: 150px;
            }

            .filter-select option {
                background: #1a1a2e;
            }

            /* Category Section */
            .category-section {
                margin-bottom: 40px;
                animation: fadeSlideIn 0.3s ease-out;
            }

            @keyframes fadeSlideIn {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .category-title {
                font-size: 20px;
                font-weight: 600;
                color: #fff;
                margin-bottom: 20px;
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .category-icon {
                font-size: 24px;
            }

            .category-count {
                background: rgba(255, 255, 255, 0.1);
                padding: 2px 10px;
                border-radius: 20px;
                font-size: 12px;
                color: #888;
            }

            /* Progress Bar */
            .progress-bar-container {
                flex: 1;
                max-width: 300px;
                height: 8px;
                background: rgba(255, 255, 255, 0.05);
                border-radius: 10px;
                overflow: hidden;
                display: flex;
                margin-left: 16px;
            }

            .progress-segment {
                height: 100%;
                transition: width 0.3s ease;
            }

            .progress-segment.initial {
                background: #6366f1;
            }

            .progress-segment.ing {
                background: #f59e0b;
            }

            .progress-segment.done {
                background: #10b981;
            }

            .category-header {
                display: flex;
                align-items: center;
                gap: 12px;
            }

            /* Subcategory */
            .subcategory-section {
                margin-left: 20px;
                margin-bottom: 24px;
                margin-top: 24px;
                padding-left: 20px;
                border-left: 2px solid rgba(99, 102, 241, 0.3);
            }

            .subcategory-title {
                font-size: 16px;
                font-weight: 500;
                color: #a5b4fc;
                margin-bottom: 16px;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .subcategory-icon {
                font-size: 18px;
            }

            /* Projects Grid */
            .projects-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: 20px;
            }

            .project-card {
                background: linear-gradient(
                    145deg,
                    rgba(255, 255, 255, 0.05) 0%,
                    rgba(255, 255, 255, 0.02) 100%
                );
                border: 1px solid rgba(255, 255, 255, 0.08);
                border-radius: 16px;
                padding: 24px;
                transition: all 0.3s ease;
            }

            .project-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            }

            .project-card.has-subcategory {
                border-left: 3px solid rgba(99, 102, 241, 0.5);
            }

            .card-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 8px;
            }

            .project-name {
                font-size: 16px;
                font-weight: 600;
                color: #fff;
                line-height: 1.4;
            }

            .card-actions {
                display: flex;
                gap: 4px;
            }

            .action-btn {
                background: transparent;
                border: none;
                padding: 6px;
                cursor: pointer;
                font-size: 14px;
                border-radius: 6px;
                transition: all 0.2s;
            }

            .action-btn:hover {
                background: rgba(255, 255, 255, 0.1);
            }

            .project-name-en {
                font-size: 12px;
                color: #666;
                margin-bottom: 12px;
                font-family: monospace;
            }

            .project-subcategory-tag {
                display: inline-block;
                font-size: 11px;
                color: #a5b4fc;
                background: rgba(99, 102, 241, 0.15);
                padding: 3px 10px;
                border-radius: 12px;
                margin-bottom: 12px;
            }

            /* Status Selector */
            .status-selector {
                display: flex;
                gap: 8px;
                margin-bottom: 16px;
            }

            .status-btn {
                flex: 1;
                padding: 8px 12px;
                background: transparent;
                border: 1px solid transparent;
                border-radius: 6px;
                cursor: pointer;
                font-size: 11px;
                font-weight: 500;
                font-family: inherit;
                transition: all 0.2s;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 4px;
                color: #666;
            }

            .status-btn:hover {
                transform: scale(1.02);
            }

            .status-btn.active {
                border-color: currentColor;
            }

            .status-btn.done {
                color: #10b981;
                background: rgba(16, 185, 129, 0.15);
                border-color: rgba(16, 185, 129, 0.3);
            }

            .status-btn.ing {
                color: #f59e0b;
                background: rgba(245, 158, 11, 0.15);
                border-color: rgba(245, 158, 11, 0.3);
            }

            .status-btn.initial {
                color: #6366f1;
                background: rgba(99, 102, 241, 0.15);
                border-color: rgba(99, 102, 241, 0.3);
            }

            .pulse-dot {
                animation: pulse 2s infinite;
                font-size: 8px;
            }

            @keyframes pulse {
                0%,
                100% {
                    opacity: 1;
                }
                50% {
                    opacity: 0.7;
                }
            }

            /* Repo Link */
            .repo-link {
                display: flex;
                align-items: center;
                gap: 8px;
                color: #a5b4fc;
                text-decoration: none;
                font-size: 12px;
                padding: 10px 14px;
                background: rgba(99, 102, 241, 0.1);
                border-radius: 8px;
                margin-bottom: 16px;
                transition: all 0.2s;
            }

            .repo-link:hover {
                background: rgba(99, 102, 241, 0.2);
            }

            .repo-link svg {
                width: 16px;
                height: 16px;
            }

            /* Date Row */
            .date-row {
                display: flex;
                gap: 16px;
            }

            .date-item {
                flex: 1;
                display: flex;
                flex-direction: column;
                gap: 4px;
            }

            .date-label {
                font-size: 10px;
                color: #666;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .date-value {
                font-size: 12px;
                color: #999;
            }

            /* Empty State */
            .empty-state {
                text-align: center;
                padding: 60px;
                color: #666;
            }

            .empty-icon {
                font-size: 48px;
                display: block;
                margin-bottom: 16px;
            }

            /* Modal */
            .modal-overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                padding: 20px;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s;
            }

            .modal-overlay.active {
                opacity: 1;
                visibility: visible;
            }

            .modal {
                background: linear-gradient(145deg, #1a1a2e 0%, #16162a 100%);
                border-radius: 20px;
                width: 100%;
                max-width: 500px;
                max-height: 90vh;
                overflow: auto;
                border: 1px solid rgba(255, 255, 255, 0.1);
                transform: translateY(20px);
                transition: all 0.3s;
            }

            .modal-overlay.active .modal {
                transform: translateY(0);
            }

            .modal-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 24px 24px 0;
            }

            .modal-title {
                font-size: 20px;
                font-weight: 600;
                color: #fff;
            }

            .close-btn {
                background: transparent;
                border: none;
                color: #666;
                font-size: 24px;
                cursor: pointer;
                padding: 4px;
                line-height: 1;
            }

            .close-btn:hover {
                color: #fff;
            }

            .form {
                padding: 24px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .form-row {
                display: flex;
                gap: 16px;
            }

            .form-row .form-group {
                flex: 1;
            }

            .label {
                display: block;
                font-size: 12px;
                color: #888;
                margin-bottom: 8px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .input {
                width: 100%;
                padding: 12px 14px;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 8px;
                color: #fff;
                font-size: 14px;
                font-family: inherit;
                transition: all 0.2s;
            }

            .input:focus {
                outline: none;
                border-color: #6366f1;
                box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
            }

            .status-radio-group {
                display: flex;
                gap: 10px;
            }

            .status-radio {
                flex: 1;
                padding: 12px;
                border: 1px solid #333;
                border-radius: 8px;
                cursor: pointer;
                text-align: center;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s;
                color: #888;
            }

            .status-radio:hover {
                border-color: #666;
            }

            .status-radio.selected {
                border-color: currentColor;
            }

            .status-radio.done.selected {
                color: #10b981;
                background: rgba(16, 185, 129, 0.15);
            }

            .status-radio.ing.selected {
                color: #f59e0b;
                background: rgba(245, 158, 11, 0.15);
            }

            .status-radio.initial.selected {
                color: #6366f1;
                background: rgba(99, 102, 241, 0.15);
            }

            .status-radio input {
                display: none;
            }

            .form-actions {
                display: flex;
                gap: 12px;
                margin-top: 24px;
            }

            .btn-cancel {
                flex: 1;
                padding: 14px;
                background: transparent;
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 8px;
                color: #888;
                cursor: pointer;
                font-size: 14px;
                font-weight: 500;
                font-family: inherit;
            }

            .btn-cancel:hover {
                background: rgba(255, 255, 255, 0.05);
            }

            .btn-submit {
                flex: 1;
                padding: 14px;
                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                border: none;
                border-radius: 8px;
                color: #fff;
                cursor: pointer;
                font-size: 14px;
                font-weight: 600;
                font-family: inherit;
                box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            }

            .btn-submit:hover {
                box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
            }

            /* Footer */
            footer {
                text-align: center;
                padding: 40px;
                color: #444;
                font-size: 12px;
                border-top: 1px solid rgba(255, 255, 255, 0.05);
                margin-top: 40px;
            }

            footer a {
                color: #6366f1;
                text-decoration: none;
            }

            .version-badge {
                display: inline-block;
                background: rgba(99, 102, 241, 0.1);
                border: 1px solid rgba(99, 102, 241, 0.2);
                padding: 4px 12px;
                border-radius: 20px;
                font-size: 11px;
                color: #a5b4fc;
                margin-top: 12px;
            }

            @media (max-width: 768px) {
                .container {
                    padding: 0 20px;
                }

                .title {
                    font-size: 24px;
                }

                .header-actions {
                    width: 100%;
                }

                .btn {
                    flex: 1;
                }

                .form-row {
                    flex-direction: column;
                }

                .projects-grid {
                    grid-template-columns: 1fr;
                }

                .subcategory-section {
                    margin-left: 10px;
                    padding-left: 15px;
                }
            }
        </style>
    </head>
    <body>
        <header>
            <div class="container header-content">
                <div>
                    <h1 class="title">
                        <span class="title-icon">‚ö°</span>
                        <span data-i18n="title">AI Project Command Center</span>
                    </h1>
                    <p class="subtitle" data-i18n="subtitle">
                        Harry's Project Portfolio Dashboard
                    </p>
                </div>
                <div class="header-actions">
                    <div class="lang-toggle">
                        <button
                            class="lang-btn active"
                            onclick="setLanguage('en')"
                        >
                            EN
                        </button>
                        <button class="lang-btn" onclick="setLanguage('zh')">
                            ‰∏≠Êñá
                        </button>
                    </div>
                    <button
                        class="btn btn-secondary"
                        onclick="resetData()"
                        title="Reset to default"
                    >
                        üîÑ <span data-i18n="reset">Reset</span>
                    </button>
                    <button
                        class="btn btn-secondary"
                        onclick="saveToGitHub()"
                        title="Save to GitHub automatically"
                    >
                        üíæ <span data-i18n="saveToGithub">Save to GitHub</span>
                    </button>
                    <button
                        class="btn btn-secondary"
                        onclick="openSettingsModal()"
                        title="GitHub Settings"
                    >
                        ‚öôÔ∏è <span data-i18n="settings">Settings</span>
                    </button>
                    <button class="btn btn-secondary" onclick="exportData()">
                        üì§ <span data-i18n="export">Export</span>
                    </button>
                    <label class="btn btn-secondary">
                        üì• <span data-i18n="import">Import</span>
                        <input
                            type="file"
                            class="file-input"
                            accept=".json"
                            onchange="importData(event)"
                        />
                    </label>
                    <button class="btn btn-primary" onclick="openModal()">
                        + <span data-i18n="newProject">New Project</span>
                    </button>
                </div>
            </div>
        </header>

        <main class="container">
            <div class="stats-bar">
                <div class="stat-card">
                    <span class="stat-number" id="stat-total">0</span>
                    <span class="stat-label" data-i18n="totalProjects"
                        >Total Projects</span
                    >
                </div>
                <div class="stat-card done">
                    <span class="stat-number" id="stat-done">0</span>
                    <span class="stat-label" data-i18n="completed"
                        >Completed</span
                    >
                </div>
                <div class="stat-card ing">
                    <span class="stat-number" id="stat-ing">0</span>
                    <span class="stat-label" data-i18n="inProgress"
                        >In Progress</span
                    >
                </div>
                <div class="stat-card initial">
                    <span class="stat-number" id="stat-initial">0</span>
                    <span class="stat-label" data-i18n="planned">Planned</span>
                </div>
            </div>

            <div class="filters">
                <input
                    type="text"
                    class="search-input"
                    data-i18n-placeholder="searchPlaceholder"
                    placeholder="üîç Search projects..."
                    id="search-input"
                    oninput="renderProjects()"
                />
                <select
                    class="filter-select"
                    id="filter-category"
                    onchange="renderProjects()"
                >
                    <option value="all" data-i18n="allCategories">
                        All Categories
                    </option>
                </select>
                <select
                    class="filter-select"
                    id="filter-status"
                    onchange="renderProjects()"
                >
                    <option value="all" data-i18n="allStatus">
                        All Status
                    </option>
                    <option value="done">‚úÖ Done</option>
                    <option value="ing">üîÑ In Progress</option>
                    <option value="initial">üìã Initial</option>
                </select>
            </div>

            <div id="projects-container"></div>
        </main>

        <footer>
            <p>
                <span data-i18n="builtWith">Built with</span> ‚ù§Ô∏è
                <span data-i18n="by">by</span> Harry |
                <a href="https://github.com/flyzhenghao" target="_blank"
                    >GitHub</a
                >
            </p>
            <div class="version-badge">v1.2.0</div>
        </footer>

        <!-- Modal -->
        <div
            class="modal-overlay"
            id="modal-overlay"
            onclick="closeModal(event)"
        >
            <div class="modal" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <h2
                        class="modal-title"
                        id="modal-title"
                        data-i18n="newProject"
                    >
                        New Project
                    </h2>
                    <button class="close-btn" onclick="closeModal()">
                        &times;
                    </button>
                </div>
                <form class="form" onsubmit="saveProject(event)">
                    <div class="form-group">
                        <label class="label" data-i18n="projectName"
                            >Project Name *</label
                        >
                        <input
                            type="text"
                            class="input"
                            id="project-name"
                            data-i18n-placeholder="projectNamePlaceholder"
                            placeholder="Enter project name"
                            required
                        />
                    </div>
                    <div class="form-group">
                        <label class="label" data-i18n="projectSlug"
                            >English Identifier</label
                        >
                        <input
                            type="text"
                            class="input"
                            id="project-name-en"
                            placeholder="project-name-slug"
                        />
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="label" data-i18n="category"
                                >Category</label
                            >
                            <select
                                class="input"
                                id="project-category"
                            ></select>
                        </div>
                        <div class="form-group">
                            <label class="label" data-i18n="newCategory"
                                >Or New Category</label
                            >
                            <input
                                type="text"
                                class="input"
                                id="new-category"
                                data-i18n-placeholder="newCategoryPlaceholder"
                                placeholder="New category name"
                            />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="label" data-i18n="subcategory"
                            >Subcategory (Optional)</label
                        >
                        <input
                            type="text"
                            class="input"
                            id="project-subcategory"
                            data-i18n-placeholder="subcategoryPlaceholder"
                            placeholder="e.g., AI Marketing"
                        />
                    </div>
                    <div class="form-group">
                        <label class="label" data-i18n="status">Status</label>
                        <div class="status-radio-group">
                            <label
                                class="status-radio initial"
                                onclick="selectStatus('initial')"
                            >
                                <input
                                    type="radio"
                                    name="status"
                                    value="initial"
                                    checked
                                />
                                <span data-i18n="statusInitial">Initial</span>
                            </label>
                            <label
                                class="status-radio ing"
                                onclick="selectStatus('ing')"
                            >
                                <input type="radio" name="status" value="ing" />
                                <span data-i18n="statusInProgress"
                                    >In Progress</span
                                >
                            </label>
                            <label
                                class="status-radio done"
                                onclick="selectStatus('done')"
                            >
                                <input
                                    type="radio"
                                    name="status"
                                    value="done"
                                />
                                <span data-i18n="statusDone">Done</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="label" data-i18n="repoUrl"
                            >GitHub Repository URL</label
                        >
                        <input
                            type="url"
                            class="input"
                            id="project-repo"
                            placeholder="https://github.com/username/repo"
                        />
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="label" data-i18n="startDate"
                                >Planned Start Date</label
                            >
                            <input
                                type="date"
                                class="input"
                                id="project-start-date"
                            />
                        </div>
                        <div class="form-group">
                            <label class="label" data-i18n="endDate"
                                >Planned End Date</label
                            >
                            <input
                                type="date"
                                class="input"
                                id="project-end-date"
                            />
                        </div>
                    </div>
                    <div class="form-actions">
                        <button
                            type="button"
                            class="btn-cancel"
                            onclick="closeModal()"
                            data-i18n="cancel"
                        >
                            Cancel
                        </button>
                        <button
                            type="submit"
                            class="btn-submit"
                            id="submit-btn"
                            data-i18n="createProject"
                        >
                            Create Project
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Settings Modal -->
        <div
            class="modal-overlay"
            id="settings-modal-overlay"
            onclick="closeSettingsModal(event)"
        >
            <div class="modal" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <h2 class="modal-title" data-i18n="githubSettings">
                        GitHub Settings
                    </h2>
                    <button class="close-btn" onclick="closeSettingsModal()">
                        &times;
                    </button>
                </div>
                <div class="form" style="padding: 24px">
                    <div class="form-group">
                        <label class="label" data-i18n="githubToken"
                            >GitHub Personal Access Token</label
                        >
                        <input
                            type="password"
                            class="input"
                            id="github-token"
                            data-i18n-placeholder="githubTokenPlaceholder"
                            placeholder="ghp_xxxxxxxxxxxx"
                        />
                        <p
                            style="
                                font-size: 12px;
                                color: #888;
                                margin-top: 8px;
                            "
                        >
                            <span data-i18n="tokenHelp">Need a token?</span>
                            <a
                                href="https://github.com/settings/tokens/new?scopes=repo&description=AI-Project-List"
                                target="_blank"
                                style="color: #6366f1"
                            >
                                <span data-i18n="createToken"
                                    >Create one here</span
                                >
                            </a>
                        </p>
                        <p
                            style="
                                font-size: 11px;
                                color: #666;
                                margin-top: 8px;
                            "
                            data-i18n="tokenStored"
                        >
                            Token will be stored securely in your browser.
                        </p>
                    </div>
                    <div class="form-group">
                        <label class="label" data-i18n="githubRepo"
                            >Repository (owner/repo)</label
                        >
                        <input
                            type="text"
                            class="input"
                            id="github-repo"
                            value="flyzhenghao/AI-Project-List"
                            readonly
                        />
                    </div>
                    <div class="form-group">
                        <label class="label" data-i18n="githubBranch"
                            >Branch</label
                        >
                        <input
                            type="text"
                            class="input"
                            id="github-branch"
                            value="main"
                            readonly
                        />
                    </div>
                    <div class="form-actions">
                        <button
                            type="button"
                            class="btn-cancel"
                            onclick="closeSettingsModal()"
                        >
                            <span data-i18n="cancel">Cancel</span>
                        </button>
                        <button
                            type="button"
                            class="btn-submit"
                            onclick="saveGitHubSettings()"
                        >
                            <span data-i18n="saveSettings">Save Settings</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Version
            const APP_VERSION = "v1.2.0";

            // Current language
            let currentLang = localStorage.getItem("lang") || "en";

            // Translations
            const translations = {
                en: {
                    title: "AI Project Command Center",
                    subtitle: "Harry's Project Portfolio Dashboard",
                    export: "Export",
                    import: "Import",
                    newProject: "New Project",
                    saveToGithub: "Save to GitHub",
                    settings: "Settings",
                    totalProjects: "Total Projects",
                    completed: "Completed",
                    inProgress: "In Progress",
                    planned: "Planned",
                    searchPlaceholder: "üîç Search projects...",
                    allCategories: "All Categories",
                    allStatus: "All Status",
                    projectName: "Project Name *",
                    projectNamePlaceholder: "Enter project name",
                    projectSlug: "English Identifier",
                    category: "Category",
                    newCategory: "Or New Category",
                    newCategoryPlaceholder: "New category name",
                    subcategory: "Subcategory (Optional)",
                    subcategoryPlaceholder: "e.g., AI Marketing",
                    status: "Status",
                    statusInitial: "Initial",
                    statusInProgress: "In Progress",
                    statusDone: "Done",
                    repoUrl: "GitHub Repository URL",
                    startDate: "Planned Start Date",
                    endDate: "Planned End Date",
                    cancel: "Cancel",
                    createProject: "Create Project",
                    saveChanges: "Save Changes",
                    editProject: "Edit Project",
                    builtWith: "Built with",
                    by: "by",
                    noProjects: "No projects found",
                    confirmDelete:
                        "Are you sure you want to delete this project?",
                    importSuccess: "Import successful!",
                    importFailed: "Import failed, please check file format",
                    start: "Start",
                    end: "End",
                    githubRepo: "GitHub Repository",
                    reset: "Reset",
                    confirmReset:
                        "Are you sure you want to reset all data to default? This will delete all your changes.",
                    resetSuccess: "Data has been reset to default!",
                    // GitHub Settings
                    githubSettings: "GitHub Settings",
                    githubToken: "GitHub Personal Access Token",
                    githubTokenPlaceholder: "ghp_xxxxxxxxxxxx",
                    tokenHelp: "Need a token?",
                    createToken: "Create one here",
                    tokenStored:
                        "Token will be stored securely in your browser.",
                    githubRepo: "Repository (owner/repo)",
                    githubBranch: "Branch",
                    saveSettings: "Save Settings",
                    savingToGithub: "Saving to GitHub...",
                    savedToGithub: "Successfully saved to GitHub! üéâ",
                    saveToGithubError:
                        "Failed to save to GitHub. Please check your token and try again.",
                    tokenRequired:
                        "Please set up your GitHub token first in Settings.",
                    // Category translations
                    cat_ÂÖÉ‰∫ßÂìÅ: "Meta Products",
                    cat_Â∑•‰Ωú: "Work",
                    cat_ÁîüÊ¥ª: "Life",
                    cat_ÊóÖË°å: "Travel",
                    cat_Â≠¶‰π†: "Learning",
                    cat_ËØª‰π¶: "Reading",
                    // Subcategory translations
                    "subcat_AI Marketing": "AI Marketing",
                },
                zh: {
                    title: "AI È°πÁõÆÊåáÊå•‰∏≠ÂøÉ",
                    subtitle: "Harry ÁöÑÈ°πÁõÆÁªÑÂêàÁÆ°ÁêÜÈù¢Êùø",
                    export: "ÂØºÂá∫",
                    import: "ÂØºÂÖ•",
                    newProject: "Êñ∞Âª∫È°πÁõÆ",
                    saveToGithub: "‰øùÂ≠òÂà∞ GitHub",
                    settings: "ËÆæÁΩÆ",
                    totalProjects: "È°πÁõÆÊÄªÊï∞",
                    completed: "Â∑≤ÂÆåÊàê",
                    inProgress: "ËøõË°å‰∏≠",
                    planned: "ËÆ°Âàí‰∏≠",
                    searchPlaceholder: "üîç ÊêúÁ¥¢È°πÁõÆ...",
                    allCategories: "ÊâÄÊúâÂàÜÁ±ª",
                    allStatus: "ÊâÄÊúâÁä∂ÊÄÅ",
                    projectName: "È°πÁõÆÂêçÁß∞ *",
                    projectNamePlaceholder: "ËæìÂÖ•È°πÁõÆÂêçÁß∞",
                    projectSlug: "Ëã±ÊñáÊ†áËØÜ",
                    category: "ÂàÜÁ±ª",
                    newCategory: "ÊàñÊñ∞Âª∫ÂàÜÁ±ª",
                    newCategoryPlaceholder: "Êñ∞ÂàÜÁ±ªÂêçÁß∞",
                    subcategory: "Â≠êÂàÜÁ±ªÔºàÂèØÈÄâÔºâ",
                    subcategoryPlaceholder: "‰æãÂ¶ÇÔºöAI Marketing",
                    status: "Áä∂ÊÄÅ",
                    statusInitial: "ËÆ°Âàí‰∏≠",
                    statusInProgress: "ËøõË°å‰∏≠",
                    statusDone: "Â∑≤ÂÆåÊàê",
                    repoUrl: "GitHub ‰ªìÂ∫ìÂú∞ÂùÄ",
                    startDate: "ËÆ°ÂàíÂºÄÂßãÊó•Êúü",
                    endDate: "ËÆ°ÂàíÁªìÊùüÊó•Êúü",
                    cancel: "ÂèñÊ∂à",
                    createProject: "ÂàõÂª∫È°πÁõÆ",
                    saveChanges: "‰øùÂ≠ò‰øÆÊîπ",
                    editProject: "ÁºñËæëÈ°πÁõÆ",
                    builtWith: "Áî®ÂøÉÊûÑÂª∫",
                    by: "‰ΩúËÄÖ",
                    noProjects: "Êú™ÊâæÂà∞È°πÁõÆ",
                    confirmDelete: "Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™È°πÁõÆÂêóÔºü",
                    importSuccess: "ÂØºÂÖ•ÊàêÂäüÔºÅ",
                    importFailed: "ÂØºÂÖ•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•Êñá‰ª∂Ê†ºÂºè",
                    start: "ÂºÄÂßã",
                    end: "ÁªìÊùü",
                    githubRepo: "GitHub ‰ªìÂ∫ì",
                    reset: "ÈáçÁΩÆ",
                    confirmReset:
                        "Á°ÆÂÆöË¶ÅÈáçÁΩÆÊâÄÊúâÊï∞ÊçÆÂà∞ÈªòËÆ§Áä∂ÊÄÅÂêóÔºüËøôÂ∞ÜÂà†Èô§ÊÇ®ÁöÑÊâÄÊúâ‰øÆÊîπ„ÄÇ",
                    resetSuccess: "Êï∞ÊçÆÂ∑≤ÈáçÁΩÆ‰∏∫ÈªòËÆ§Áä∂ÊÄÅÔºÅ",
                    // GitHub Settings
                    githubSettings: "GitHub ËÆæÁΩÆ",
                    githubToken: "GitHub ‰∏™‰∫∫ËÆøÈóÆ‰ª§Áâå",
                    githubTokenPlaceholder: "ghp_xxxxxxxxxxxx",
                    tokenHelp: "ÈúÄË¶Å‰ª§ÁâåÔºü",
                    createToken: "ÁÇπÂáªËøôÈáåÂàõÂª∫",
                    tokenStored: "‰ª§ÁâåÂ∞ÜÂÆâÂÖ®Âú∞Â≠òÂÇ®Âú®ÊÇ®ÁöÑÊµèËßàÂô®‰∏≠„ÄÇ",
                    githubRepo: "‰ªìÂ∫ì (ÊâÄÊúâËÄÖ/‰ªìÂ∫ìÂêç)",
                    githubBranch: "ÂàÜÊîØ",
                    saveSettings: "‰øùÂ≠òËÆæÁΩÆ",
                    savingToGithub: "Ê≠£Âú®‰øùÂ≠òÂà∞ GitHub...",
                    savedToGithub: "ÊàêÂäü‰øùÂ≠òÂà∞ GitHubÔºÅüéâ",
                    saveToGithubError:
                        "‰øùÂ≠òÂà∞ GitHub Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÊÇ®ÁöÑ‰ª§ÁâåÂêéÈáçËØï„ÄÇ",
                    tokenRequired: "ËØ∑ÂÖàÂú®ËÆæÁΩÆ‰∏≠ÈÖçÁΩÆ GitHub ‰ª§Áâå„ÄÇ",
                    // Category translations
                    cat_ÂÖÉ‰∫ßÂìÅ: "ÂÖÉ‰∫ßÂìÅ",
                    cat_Â∑•‰Ωú: "Â∑•‰Ωú",
                    cat_ÁîüÊ¥ª: "ÁîüÊ¥ª",
                    cat_ÊóÖË°å: "ÊóÖË°å",
                    cat_Â≠¶‰π†: "Â≠¶‰π†",
                    cat_ËØª‰π¶: "ËØª‰π¶",
                    // Subcategory translations
                    "subcat_AI Marketing": "AI Ëê•ÈîÄ",
                },
            };

            // Get translated text
            function t(key) {
                return translations[currentLang][key] || key;
            }

            // Set language
            function setLanguage(lang) {
                currentLang = lang;
                localStorage.setItem("lang", lang);

                // Update language toggle buttons
                document.querySelectorAll(".lang-btn").forEach((btn) => {
                    btn.classList.remove("active");
                    if (
                        (lang === "en" && btn.textContent === "EN") ||
                        (lang === "zh" && btn.textContent === "‰∏≠Êñá")
                    ) {
                        btn.classList.add("active");
                    }
                });

                // Update all translatable elements
                document.querySelectorAll("[data-i18n]").forEach((el) => {
                    const key = el.getAttribute("data-i18n");
                    el.textContent = t(key);
                });

                // Update placeholders
                document
                    .querySelectorAll("[data-i18n-placeholder]")
                    .forEach((el) => {
                        const key = el.getAttribute("data-i18n-placeholder");
                        el.placeholder = t(key);
                    });

                // Update select options
                updateFilterStatusOptions();
                updateCategoryFilter();

                // Re-render projects with new language
                renderProjects();
            }

            function updateFilterStatusOptions() {
                const select = document.getElementById("filter-status");
                const currentValue = select.value;
                select.innerHTML = `
                <option value="all">${t("allStatus")}</option>
                <option value="done">‚úÖ ${t("statusDone")}</option>
                <option value="ing">üîÑ ${t("statusInProgress")}</option>
                <option value="initial">üìã ${t("statusInitial")}</option>
            `;
                select.value = currentValue;
            }

            // Category icons mapping
            const categoryIcons = {
                ÂÖÉ‰∫ßÂìÅ: "üß¨",
                Â∑•‰Ωú: "üíº",
                ÁîüÊ¥ª: "üå±",
                ÊóÖË°å: "‚úàÔ∏è",
                Â≠¶‰π†: "üìö",
                ËØª‰π¶: "üìñ",
            };

            // Subcategory icons
            const subcategoryIcons = {
                "AI Marketing": "üéØ",
            };

            // Initial projects data
            const initialProjects = [
                {
                    id: 1,
                    name: "‰∫ßÂìÅÂºÄÂèëÊñπÊ≥ïËÆ∫ÂàÜÊûê",
                    nameEn: "product-design-methodology-generator",
                    category: "ÂÖÉ‰∫ßÂìÅ",
                    subcategory: "",
                    status: "done",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 2,
                    name: "Á´ûÂìÅÂàÜÊûê",
                    nameEn: "competitor-analysis",
                    category: "ÂÖÉ‰∫ßÂìÅ",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 3,
                    name: "‰∫ßÂìÅÂºÄÂèëËÆ°Âàí‰∏ÄËßàË°®",
                    nameEn: "product-dev-overview",
                    category: "ÂÖÉ‰∫ßÂìÅ",
                    subcategory: "",
                    status: "ing",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 4,
                    name: "Next Gen AI Agent",
                    nameEn: "next-gen-ai-agent",
                    category: "Â∑•‰Ωú",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 5,
                    name: "Business Website",
                    nameEn: "business-website",
                    category: "Â∑•‰Ωú",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 6,
                    name: "Street Hip-hop Video",
                    nameEn: "street-hiphop-video",
                    category: "Â∑•‰Ωú",
                    subcategory: "AI Marketing",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 7,
                    name: "AI Impact On Real Estate",
                    nameEn: "ai-real-estate",
                    category: "Â∑•‰Ωú",
                    subcategory: "",
                    status: "ing",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 8,
                    name: "‰∏™‰∫∫Â§çÁõòÔºå‰∫∫ÁîüÊó•ËÆ∞",
                    nameEn: "life-review-diary",
                    category: "ÁîüÊ¥ª",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 9,
                    name: "Êó∂Èó¥ËÆ∞ÂΩï",
                    nameEn: "time-tracking",
                    category: "ÁîüÊ¥ª",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 10,
                    name: "‰Ω†‰∏ÄÁîüÁöÑÊóÖÁ®ã",
                    nameEn: "life-journey",
                    category: "ÁîüÊ¥ª",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 11,
                    name: "Â•áÁâπÁöÑ‰∏ÄÁîü",
                    nameEn: "extraordinary-life",
                    category: "ÁîüÊ¥ª",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 12,
                    name: "2025 Xmas Camping",
                    nameEn: "2025-xmas-camping",
                    category: "ÊóÖË°å",
                    subcategory: "",
                    status: "done",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 13,
                    name: "2025 Xmas Trip",
                    nameEn: "2025-xmas-trip",
                    category: "ÊóÖË°å",
                    subcategory: "",
                    status: "done",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 14,
                    name: "Yang Â≠¶‰π†‰Ωú‰∏ö",
                    nameEn: "rangitoto-review-Y9",
                    category: "Â≠¶‰π†",
                    subcategory: "",
                    status: "done",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 15,
                    name: "‰π¶Á±çÊ†∏ÂøÉÂÜÖÂÆπÊèêÂèñÔºåÂä®ÊÄÅÊºîÁ§∫",
                    nameEn: "vant-emergence",
                    category: "ËØª‰π¶",
                    subcategory: "",
                    status: "initial",
                    repo: "",
                    startDate: "",
                    endDate: "",
                },
                {
                    id: 16,
                    name: "Â≠¶‰ª•Ëá¥Áî®ÔºöÂÜ≥Á≠ñÁ≥ªÁªü",
                    nameEn: "decision-making-system",
                    category: "ËØª‰π¶",
                    subcategory: "",
                    status: "initial",
                    repo: "https://github.com/flyzhenghao/decision-making-system",
                    startDate: "",
                    endDate: "",
                },
            ];

            let projects = [];
            let editingProjectId = null;

            // Initialize
            document.addEventListener("DOMContentLoaded", async () => {
                await loadProjects();
                setLanguage(currentLang);
                renderProjects();
                updateCategoryFilter();
            });

            async function loadProjects() {
                // Try to load from data.json first
                try {
                    const response = await fetch("data.json?t=" + Date.now());
                    if (response.ok) {
                        const data = await response.json();
                        if (data.projects && Array.isArray(data.projects)) {
                            projects = data.projects;
                            console.log("Loaded projects from data.json");
                            // Also save to localStorage as backup
                            saveToStorage();
                            localStorage.setItem(
                                "aiProjectsVersion",
                                APP_VERSION,
                            );
                            return;
                        }
                    }
                } catch (error) {
                    console.log(
                        "Could not load data.json, using localStorage fallback",
                    );
                }

                // Fallback to localStorage or initial data
                const saved = localStorage.getItem("aiProjects");
                const dataVersion = localStorage.getItem("aiProjectsVersion");

                // Check if we need to reset to get new default data structure
                if (saved && dataVersion !== APP_VERSION) {
                    // Migrate existing data with new subcategory mappings
                    projects = JSON.parse(saved);

                    // Define subcategory mappings for migration
                    const subcategoryMappings = {
                        "street-hiphop-video": "AI Marketing",
                        "Street Hip-hop Video": "AI Marketing",
                    };

                    projects = projects.map((p) => {
                        let subcategory = p.subcategory || "";

                        // Check if this project should have a subcategory
                        if (
                            !subcategory &&
                            (subcategoryMappings[p.nameEn] ||
                                subcategoryMappings[p.name])
                        ) {
                            subcategory =
                                subcategoryMappings[p.nameEn] ||
                                subcategoryMappings[p.name];
                        }

                        return {
                            ...p,
                            subcategory,
                        };
                    });

                    localStorage.setItem("aiProjectsVersion", APP_VERSION);
                    saveToStorage();
                } else if (saved) {
                    projects = JSON.parse(saved);
                } else {
                    projects = [...initialProjects];
                    localStorage.setItem("aiProjectsVersion", APP_VERSION);
                    saveToStorage();
                }
            }

            function saveToStorage() {
                localStorage.setItem("aiProjects", JSON.stringify(projects));
            }

            function getCategories() {
                return [...new Set(projects.map((p) => p.category))];
            }

            function getCategoryDisplayName(cat) {
                const key = "cat_" + cat;
                return t(key) || cat;
            }

            function getSubcategoryDisplayName(subcat) {
                if (!subcat) return "";
                const key = "subcat_" + subcat;
                return t(key) || subcat;
            }

            function updateCategoryFilter() {
                const select = document.getElementById("filter-category");
                const categorySelect =
                    document.getElementById("project-category");
                const categories = getCategories();

                select.innerHTML = `<option value="all">${t("allCategories")}</option>`;
                categorySelect.innerHTML = "";

                categories.forEach((cat) => {
                    const icon = categoryIcons[cat] || "üìÅ";
                    const displayName = getCategoryDisplayName(cat);
                    select.innerHTML += `<option value="${cat}">${icon} ${displayName}</option>`;
                    categorySelect.innerHTML += `<option value="${cat}">${icon} ${displayName}</option>`;
                });
            }

            function updateStats() {
                document.getElementById("stat-total").textContent =
                    projects.length;
                document.getElementById("stat-done").textContent =
                    projects.filter((p) => p.status === "done").length;
                document.getElementById("stat-ing").textContent =
                    projects.filter((p) => p.status === "ing").length;
                document.getElementById("stat-initial").textContent =
                    projects.filter((p) => p.status === "initial").length;
            }

            // Calculate progress statistics for a list of projects
            function calculateProgress(projectList) {
                const total = projectList.length;
                if (total === 0) {
                    return {
                        initial: 0,
                        ing: 0,
                        done: 0,
                        initialPct: 0,
                        ingPct: 0,
                        donePct: 0,
                    };
                }

                const initial = projectList.filter(
                    (p) => p.status === "initial",
                ).length;
                const ing = projectList.filter(
                    (p) => p.status === "ing",
                ).length;
                const done = projectList.filter(
                    (p) => p.status === "done",
                ).length;

                return {
                    initial,
                    ing,
                    done,
                    initialPct: ((initial / total) * 100).toFixed(1),
                    ingPct: ((ing / total) * 100).toFixed(1),
                    donePct: ((done / total) * 100).toFixed(1),
                };
            }

            // Render progress bar HTML
            function renderProgressBar(stats) {
                if (
                    stats.initial === 0 &&
                    stats.ing === 0 &&
                    stats.done === 0
                ) {
                    return "";
                }

                return `
                    <div class="progress-bar-container" title="${t("statusInitial")}: ${stats.initial} | ${t("statusInProgress")}: ${stats.ing} | ${t("statusDone")}: ${stats.done}">
                        ${stats.initial > 0 ? `<div class="progress-segment initial" style="width: ${stats.initialPct}%"></div>` : ""}
                        ${stats.ing > 0 ? `<div class="progress-segment ing" style="width: ${stats.ingPct}%"></div>` : ""}
                        ${stats.done > 0 ? `<div class="progress-segment done" style="width: ${stats.donePct}%"></div>` : ""}
                    </div>
                `;
            }

            function renderProjects() {
                const container = document.getElementById("projects-container");
                const search = document
                    .getElementById("search-input")
                    .value.toLowerCase();
                const categoryFilter =
                    document.getElementById("filter-category").value;
                const statusFilter =
                    document.getElementById("filter-status").value;

                const filtered = projects.filter((p) => {
                    const matchSearch =
                        p.name.toLowerCase().includes(search) ||
                        p.nameEn.toLowerCase().includes(search) ||
                        (p.subcategory &&
                            p.subcategory.toLowerCase().includes(search));
                    const matchCategory =
                        categoryFilter === "all" ||
                        p.category === categoryFilter;
                    const matchStatus =
                        statusFilter === "all" || p.status === statusFilter;
                    return matchSearch && matchCategory && matchStatus;
                });

                // Group by category, then by subcategory
                const grouped = {};
                filtered.forEach((p) => {
                    if (!grouped[p.category]) {
                        grouped[p.category] = { noSub: [], subs: {} };
                    }
                    if (p.subcategory) {
                        if (!grouped[p.category].subs[p.subcategory]) {
                            grouped[p.category].subs[p.subcategory] = [];
                        }
                        grouped[p.category].subs[p.subcategory].push(p);
                    } else {
                        grouped[p.category].noSub.push(p);
                    }
                });

                if (Object.keys(grouped).length === 0) {
                    container.innerHTML = `
                    <div class="empty-state">
                        <span class="empty-icon">üì≠</span>
                        <p>${t("noProjects")}</p>
                    </div>
                `;
                } else {
                    container.innerHTML = Object.entries(grouped)
                        .map(([category, data]) => {
                            const totalCount =
                                data.noSub.length +
                                Object.values(data.subs).reduce(
                                    (sum, arr) => sum + arr.length,
                                    0,
                                );
                            const categoryDisplayName =
                                getCategoryDisplayName(category);

                            // Calculate progress for all projects in this category
                            const allCategoryProjects = [
                                ...data.noSub,
                                ...Object.values(data.subs).flat(),
                            ];
                            const categoryProgress =
                                calculateProgress(allCategoryProjects);

                            let html = `
                        <div class="category-section">
                            <div class="category-header">
                                <h2 class="category-title">
                                    <span class="category-icon">${categoryIcons[category] || "üìÅ"}</span>
                                    ${categoryDisplayName}
                                    <span class="category-count">${totalCount}</span>
                                </h2>
                                ${renderProgressBar(categoryProgress)}
                            </div>
                    `;

                            // Render projects without subcategory
                            if (data.noSub.length > 0) {
                                html += `
                            <div class="projects-grid">
                                ${data.noSub.map((p) => renderProjectCard(p)).join("")}
                            </div>
                        `;
                            }

                            // Render subcategories
                            Object.entries(data.subs).forEach(
                                ([subcat, subProjects]) => {
                                    const subcatDisplayName =
                                        getSubcategoryDisplayName(subcat);
                                    const subcatProgress =
                                        calculateProgress(subProjects);
                                    html += `
                            <div class="subcategory-section">
                                <div class="category-header">
                                    <h3 class="subcategory-title">
                                        <span class="subcategory-icon">${subcategoryIcons[subcat] || "üìÇ"}</span>
                                        ${subcatDisplayName}
                                        <span class="category-count">${subProjects.length}</span>
                                    </h3>
                                    ${renderProgressBar(subcatProgress)}
                                </div>
                                <div class="projects-grid">
                                    ${subProjects.map((p) => renderProjectCard(p, true)).join("")}
                                </div>
                            </div>
                        `;
                                },
                            );

                            html += "</div>";
                            return html;
                        })
                        .join("");
                }

                updateStats();
            }

            function renderProjectCard(project, hasSubcategory = false) {
                const statusLabels = {
                    done: t("statusDone"),
                    ing: t("statusInProgress"),
                    initial: t("statusInitial"),
                };

                return `
                <div class="project-card ${hasSubcategory ? "has-subcategory" : ""}">
                    <div class="card-header">
                        <h3 class="project-name">${project.name}</h3>
                        <div class="card-actions">
                            <button class="action-btn" onclick="editProject(${project.id})" title="Edit">‚úèÔ∏è</button>
                            <button class="action-btn" onclick="deleteProject(${project.id})" title="Delete">üóëÔ∏è</button>
                        </div>
                    </div>
                    <p class="project-name-en">${project.nameEn}</p>
                    ${project.subcategory ? `<span class="project-subcategory-tag">${getSubcategoryDisplayName(project.subcategory)}</span>` : ""}
                    <div class="status-selector">
                        ${["initial", "ing", "done"]
                            .map(
                                (status) => `
                            <button class="status-btn ${status} ${project.status === status ? "active" : ""}"
                                    onclick="changeStatus(${project.id}, '${status}')">
                                ${project.status === status ? '<span class="pulse-dot">‚óè</span>' : ""}
                                ${statusLabels[status]}
                            </button>
                        `,
                            )
                            .join("")}
                    </div>
                    ${
                        project.repo
                            ? `
                        <a href="${project.repo}" target="_blank" class="repo-link">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                            </svg>
                            ${t("githubRepo")}
                        </a>
                    `
                            : ""
                    }
                    <div class="date-row">
                        <div class="date-item">
                            <span class="date-label">${t("start")}</span>
                            <span class="date-value">${project.startDate || "‚Äî"}</span>
                        </div>
                        <div class="date-item">
                            <span class="date-label">${t("end")}</span>
                            <span class="date-value">${project.endDate || "‚Äî"}</span>
                        </div>
                    </div>
                </div>
            `;
            }

            function changeStatus(id, newStatus) {
                const project = projects.find((p) => p.id === id);
                if (project) {
                    project.status = newStatus;
                    saveToStorage();
                    renderProjects();
                }
            }

            function deleteProject(id) {
                if (confirm(t("confirmDelete"))) {
                    projects = projects.filter((p) => p.id !== id);
                    saveToStorage();
                    renderProjects();
                    updateCategoryFilter();
                }
            }

            function editProject(id) {
                const project = projects.find((p) => p.id === id);
                if (project) {
                    editingProjectId = id;
                    document.getElementById("modal-title").textContent =
                        t("editProject");
                    document
                        .getElementById("modal-title")
                        .setAttribute("data-i18n", "editProject");
                    document.getElementById("submit-btn").textContent =
                        t("saveChanges");
                    document
                        .getElementById("submit-btn")
                        .setAttribute("data-i18n", "saveChanges");
                    document.getElementById("project-name").value =
                        project.name;
                    document.getElementById("project-name-en").value =
                        project.nameEn;
                    document.getElementById("project-category").value =
                        project.category;
                    document.getElementById("new-category").value = "";
                    document.getElementById("project-subcategory").value =
                        project.subcategory || "";
                    document.getElementById("project-repo").value =
                        project.repo;
                    document.getElementById("project-start-date").value =
                        project.startDate;
                    document.getElementById("project-end-date").value =
                        project.endDate;
                    selectStatus(project.status);
                    document
                        .getElementById("modal-overlay")
                        .classList.add("active");
                }
            }

            function openModal() {
                editingProjectId = null;
                document.getElementById("modal-title").textContent =
                    t("newProject");
                document
                    .getElementById("modal-title")
                    .setAttribute("data-i18n", "newProject");
                document.getElementById("submit-btn").textContent =
                    t("createProject");
                document
                    .getElementById("submit-btn")
                    .setAttribute("data-i18n", "createProject");
                document.getElementById("project-name").value = "";
                document.getElementById("project-name-en").value = "";
                document.getElementById("new-category").value = "";
                document.getElementById("project-subcategory").value = "";
                document.getElementById("project-repo").value = "";
                document.getElementById("project-start-date").value = "";
                document.getElementById("project-end-date").value = "";
                selectStatus("initial");
                updateCategoryFilter();
                document
                    .getElementById("modal-overlay")
                    .classList.add("active");
            }

            function closeModal(event) {
                if (!event || event.target === event.currentTarget) {
                    document
                        .getElementById("modal-overlay")
                        .classList.remove("active");
                }
            }

            function selectStatus(status) {
                document.querySelectorAll(".status-radio").forEach((el) => {
                    el.classList.remove("selected");
                    el.querySelector("input").checked = false;
                });
                const selected = document.querySelector(
                    `.status-radio.${status}`,
                );
                if (selected) {
                    selected.classList.add("selected");
                    selected.querySelector("input").checked = true;
                }
            }

            function saveProject(event) {
                event.preventDefault();

                const name = document
                    .getElementById("project-name")
                    .value.trim();
                if (!name) {
                    alert(
                        currentLang === "zh"
                            ? "ËØ∑ËæìÂÖ•È°πÁõÆÂêçÁß∞"
                            : "Please enter project name",
                    );
                    return;
                }

                const newCategory = document
                    .getElementById("new-category")
                    .value.trim();
                const category =
                    newCategory ||
                    document.getElementById("project-category").value;
                const status =
                    document.querySelector(".status-radio.selected input")
                        ?.value || "initial";

                const projectData = {
                    name,
                    nameEn: document
                        .getElementById("project-name-en")
                        .value.trim(),
                    category,
                    subcategory: document
                        .getElementById("project-subcategory")
                        .value.trim(),
                    status,
                    repo: document.getElementById("project-repo").value.trim(),
                    startDate:
                        document.getElementById("project-start-date").value,
                    endDate: document.getElementById("project-end-date").value,
                };

                if (editingProjectId) {
                    const index = projects.findIndex(
                        (p) => p.id === editingProjectId,
                    );
                    if (index !== -1) {
                        projects[index] = {
                            ...projectData,
                            id: editingProjectId,
                        };
                    }
                } else {
                    projects.push({ ...projectData, id: Date.now() });
                }

                saveToStorage();
                renderProjects();
                updateCategoryFilter();
                closeModal();
            }

            function exportData() {
                const dataStr = JSON.stringify(projects, null, 2);
                const blob = new Blob([dataStr], { type: "application/json" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "ai-projects-backup.json";
                a.click();
                URL.revokeObjectURL(url);
            }

            function exportDataJson() {
                const dataObj = {
                    version: APP_VERSION,
                    lastUpdated: new Date().toISOString(),
                    projects: projects,
                };
                const dataStr = JSON.stringify(dataObj, null, 2);
                const blob = new Blob([dataStr], { type: "application/json" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "data.json";
                a.click();
                URL.revokeObjectURL(url);

                const message =
                    currentLang === "zh"
                        ? "Êï∞ÊçÆÂ∑≤‰∏ãËΩΩÔºÅËØ∑Â∞Ü data.json Êñá‰ª∂‰∏ä‰º†Âà∞ GitHub ‰ªìÂ∫ì‰ª•‰øùÂ≠òÊõ¥Êîπ„ÄÇ"
                        : "Data downloaded! Please upload data.json to your GitHub repository to save changes.";
                alert(message);
            }

            function importData(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const imported = JSON.parse(e.target.result);
                            if (Array.isArray(imported)) {
                                // Migrate old data - add subcategory field if missing
                                projects = imported.map((p) => ({
                                    ...p,
                                    subcategory: p.subcategory || "",
                                }));
                                saveToStorage();
                                renderProjects();
                                updateCategoryFilter();
                                alert(t("importSuccess"));
                            } else {
                                alert(t("importFailed"));
                            }
                        } catch (err) {
                            alert(t("importFailed"));
                        }
                    };
                    reader.readAsText(file);
                }
                event.target.value = "";
            }

            function resetData() {
                if (confirm(t("confirmReset"))) {
                    localStorage.removeItem("aiProjects");
                    localStorage.removeItem("aiProjectsVersion");
                    projects = [...initialProjects];
                    localStorage.setItem("aiProjectsVersion", APP_VERSION);
                    saveToStorage();
                    renderProjects();
                    updateCategoryFilter();
                    alert(t("resetSuccess"));
                }
            }

            // GitHub Settings Functions
            function openSettingsModal() {
                const token = localStorage.getItem("githubToken") || "";
                document.getElementById("github-token").value = token;
                document
                    .getElementById("settings-modal-overlay")
                    .classList.add("active");
            }

            function closeSettingsModal(event) {
                if (!event || event.target === event.currentTarget) {
                    document
                        .getElementById("settings-modal-overlay")
                        .classList.remove("active");
                }
            }

            function saveGitHubSettings() {
                const token = document
                    .getElementById("github-token")
                    .value.trim();
                if (token) {
                    localStorage.setItem("githubToken", token);
                    alert(
                        currentLang === "zh"
                            ? "ËÆæÁΩÆÂ∑≤‰øùÂ≠òÔºÅ"
                            : "Settings saved!",
                    );
                    closeSettingsModal();
                } else {
                    alert(
                        currentLang === "zh"
                            ? "ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑ GitHub Token"
                            : "Please enter a valid GitHub Token",
                    );
                }
            }

            // GitHub API Save Function
            async function saveToGitHub(event) {
                const token = localStorage.getItem("githubToken");

                if (!token) {
                    if (
                        confirm(
                            t("tokenRequired") +
                                "\n\n" +
                                (currentLang === "zh"
                                    ? "Áé∞Âú®ÊâìÂºÄËÆæÁΩÆÔºü"
                                    : "Open settings now?"),
                        )
                    ) {
                        openSettingsModal();
                    }
                    return;
                }

                const owner = "flyzhenghao";
                const repo = "AI-Project-List";
                const branch = "main";
                const filePath = "data.json";

                // Get the button element
                const button = event ? event.target.closest("button") : null;
                const originalText = button ? button.innerHTML : null;

                try {
                    // Show loading message
                    if (button) {
                        button.innerHTML =
                            "<span>‚è≥ " + t("savingToGithub") + "</span>";
                        button.disabled = true;
                    }

                    // Prepare data
                    const dataObj = {
                        version: APP_VERSION,
                        lastUpdated: new Date().toISOString(),
                        projects: projects,
                    };
                    const content = JSON.stringify(dataObj, null, 2);
                    const encodedContent = btoa(
                        unescape(encodeURIComponent(content)),
                    );

                    // Get current file SHA
                    const getResponse = await fetch(
                        `https://api.github.com/repos/${owner}/${repo}/contents/${filePath}?ref=${branch}`,
                        {
                            headers: {
                                Authorization: `token ${token}`,
                                Accept: "application/vnd.github.v3+json",
                            },
                        },
                    );

                    if (!getResponse.ok) {
                        throw new Error("Failed to get current file");
                    }

                    const fileData = await getResponse.json();
                    const sha = fileData.sha;

                    // Update file
                    const updateResponse = await fetch(
                        `https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`,
                        {
                            method: "PUT",
                            headers: {
                                Authorization: `token ${token}`,
                                Accept: "application/vnd.github.v3+json",
                                "Content-Type": "application/json",
                            },
                            body: JSON.stringify({
                                message: `Update project data - ${new Date().toISOString()}`,
                                content: encodedContent,
                                sha: sha,
                                branch: branch,
                            }),
                        },
                    );

                    if (button) {
                        button.innerHTML = originalText;
                        button.disabled = false;
                    }

                    if (updateResponse.ok) {
                        alert(t("savedToGithub"));
                    } else {
                        const errorData = await updateResponse.json();
                        console.error("GitHub API Error:", errorData);
                        throw new Error(
                            errorData.message || "Failed to update file",
                        );
                    }
                } catch (error) {
                    console.error("Error saving to GitHub:", error);
                    alert(t("saveToGithubError") + "\n\n" + error.message);

                    if (button) {
                        button.innerHTML = originalText;
                        button.disabled = false;
                    }
                }
            }
        </script>
    </body>
</html>
